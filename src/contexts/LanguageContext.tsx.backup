import React, { createContext, useContext, useState, useEffect, ReactNode } from 'react';

interface LanguageContextType {
  language: string;
  t: (key: string) => string;
  setLanguage: (lang: string) => void;
  toggleLanguage: () => void;
}

const LanguageContext = createContext<LanguageContextType | undefined>(undefined);

export const LanguageProvider = ({ children }: { children: ReactNode }) => {
  const [language, setLanguage] = useState(localStorage.getItem('lang') || 'en');

  useEffect(() => {
    localStorage.setItem('lang', language);
  }, [language]);

  const enTranslations = {
    dashboard: 'Dashboard',
    transactions: 'Transactions',
    budgets: 'Budgets',
    wallets: 'Wallets',
    gam3eya: 'Gam3eya',
    reminders: 'Reminders',
    reports: 'Reports',
    settings: 'Settings',
    login: 'Login',
    register: 'Register',
    logout: 'Logout',
    username: 'Username',
    email: 'Email',
    password: 'Password',
    confirm_password: 'Confirm Password',
    create_account: 'Create Account',
    already_have_account: 'Already have an account?',
    login_here: 'Login here',
    need_an_account: 'Need an account?',
    register_here: 'Register here',
    enter_username: 'Enter your username',
    enter_email: 'Enter your email',
    enter_password: 'Enter your password',
    enter_confirm_password: 'Enter your confirm password',
    invalid_email: 'Invalid email',
    passwords_do_not_match: 'Passwords do not match',
    home: 'Home',
    total_balance: 'Total Balance',
    income: 'Income',
    expenses: 'Expenses',
    latest_transactions: 'Latest Transactions',
    view_all: 'View All',
    add_transaction: 'Add Transaction',
    date: 'Date',
    amount: 'Amount',
    description: 'Description',
    category: 'Category',
    wallet: 'Wallet',
    type: 'Type',
    income_transaction: 'Income Transaction',
    expense_transaction: 'Expense Transaction',
    select_category: 'Select Category',
    select_wallet: 'Select Wallet',
    enter_amount: 'Enter amount',
    enter_description: 'Enter description',
    add: 'Add',
    edit: 'Edit',
    delete: 'Delete',
    cancel: 'Cancel',
    are_you_sure: 'Are you sure?',
    this_action_cannot_be_undone: 'This action cannot be undone.',
    yes_delete: 'Yes, Delete',
    no_cancel: 'No, Cancel',
    new_wallet: 'New Wallet',
    name: 'Name',
    balance: 'Balance',
    color: 'Color',
    type_of_wallet: 'Type of Wallet',
    enter_name: 'Enter name',
    enter_balance: 'Enter balance',
    select_color: 'Select color',
    create: 'Create',
    edit_wallet: 'Edit Wallet',
    cash: 'Cash',
    bank_account: 'Bank Account',
    credit_card: 'Credit Card',
    debit_card: 'Debit Card',
    mobile_money: 'Mobile Money',
    investment: 'Investment',
    other: 'Other',
    total: 'Total',
    remaining: 'Remaining',
    spent: 'Spent',
    budget_amount: 'Budget Amount',
    start_date: 'Start Date',
    end_date: 'End Date',
    create_budget: 'Create Budget',
    edit_budget: 'Edit Budget',
    enter_budget_amount: 'Enter budget amount',
    select_start_date: 'Select start date',
    select_end_date: 'Select end date',
    new_category: 'New Category',
    category_name: 'Category Name',
    category_type: 'Category Type',
    enter_category_name: 'Enter category name',
    select_category_type: 'Select category type',
    expense: 'Expense',
    income_category: 'Income',
    both: 'Both',
    is_custom: 'Is Custom',
    category_added_successfully: 'Category added successfully!',
    failed_to_add_category: 'Failed to add category.',
    category_already_exists: 'Category with the same name already exists for this type.',
    info: 'Info',
    categories_reset_not_available: 'Categories reset functionality is not available yet.',
    error: 'Error',
    failed_to_load_categories: 'Failed to load categories.',
    success: 'Success',
    logged_in_successfully: 'Logged in successfully!',    registered_successfully: 'Registered successfully!',
    logged_out_successfully: 'Logged out successfully!',
    invalid_credentials: 'Invalid credentials',
    monthly_comparison: "Monthly income vs expenses",
    yearly_comparison: "Yearly income vs expenses",    monthly_cash_flow: "Monthly cash flow analysis",
    yearly_cash_flow: "Yearly cash flow analysis",
    cash_flow: "Cash Flow",
    monthly_distribution: "Monthly expense distribution",
    yearly_distribution: "Yearly expense distribution",
    income_expense_comparison_description: "Compare your income and expenses over time",
    cash_flow_description: "Track your net cash flow and running balance",
    expense_distribution_description: "See where your money is going",
    wallet_transaction_history: "Recent transaction history",
    uncategorized: "Uncategorized",
    
    // Login & Register specific
    login_title: "Login",
    enter_email_password: "Enter your email and password to access your account",
    your_email: "Your email",
    your_password: "Your password",
    logging_in: "Logging in...",
    dont_have_account: "Don't have an account?",
    create_account_title: "Create an account",
    enter_details_new_account: "Enter your details to create a new account",
    your_username: "Your username",
    create_a_password: "Create a password",
    confirm_your_password: "Confirm your password",
    creating_account: "Creating account...",
      // Settings
    phone: "Phone",
    profile_settings: "Profile Settings",
    language_settings: "Language Settings",
    current_language: "Current language",
    switch_to_arabic: "Switch to Arabic",
    switch_to_english: "Switch to English",
    notifications: "Notifications",
    manage_notifications: "Manage your notification preferences",
    email_notifications: "Email notifications",
    receive_email_updates: "Receive email updates about your account",
    push_notifications: "Push notifications",
    receive_push_notifications: "Receive push notifications on your device",
    security: "Security",
    change_password: "Change Password",
    manage_connected_accounts: "Manage Connected Accounts",
    profile_updated: "Profile updated",
    profile_updated_successfully: "Your profile has been updated successfully",
    not_available: "N/A",
    username_required: "Username is required",
    email_required: "Email is required",
    
    // Loading states
    loading: "Loading",
    loading_wallets: "Loading wallets",
    loading_reports_data: "Loading reports data",
    loading_gam3eyas: "Loading gam3eyas",
    
    // Placeholders
    amount_placeholder: "0.00",
    phone_placeholder: "+20 123 456 7890",
    
    // Validation messages
    please_enter_valid_email: "Please enter a valid email",
    password_min_6_chars: "Password must be at least 6 characters",
    username_min_3_chars: "Username must be at least 3 characters",
    name_required: "Name is required",
    amount_must_be_positive: "Amount must be positive",
    members_must_be_positive: "Members must be positive",
    contribution_must_be_positive: "Contribution must be positive",
    start_date_required: "Start date is required",
    end_date_required: "End date is required",
    
    // Gam3eya specific
    gam3eya_name: "Gam3eya name",
    total_amount: "Total amount",
    monthly_contribution: "Monthly contribution",
    members_count: "Members count",
    calculated_from_members: "Calculated from total amount ÷ members",
    calculated_automatically: "Calculated automatically",
    my_turn: "My turn",
    which_cycle_you_receive: "Which cycle you receive the payout",
    current_cycle: "Current cycle",
    cycle: "Cycle",
    halfway_complete: "Halfway complete",
    edit_gam3eya: "Edit Gam3eya",
    create_new_gam3eya: "Create new Gam3eya",
    fill_details_to_create_gam3eya: "Fill in the details to create your gam3eya",
    delete_gam3eya: "Delete Gam3eya",
    delete_gam3eya_confirmation: "Are you sure you want to delete {name}?",
    save_changes: "Save changes",
    gam3eya_created_successfully: "Gam3eya created successfully",
    gam3eya_updated_successfully: "Gam3eya updated successfully",
    gam3eya_deleted_successfully: "Gam3eya deleted successfully",
    failed_to_create_gam3eya: "Failed to create gam3eya",
    failed_to_update_gam3eya: "Failed to update gam3eya",
    failed_to_delete_gam3eya: "Failed to delete gam3eya",
    failed_to_fetch_gam3eyas: "Failed to fetch gam3eyas",
    no_gam3eya_yet: "No Gam3eya yet",
    start_by_creating_gam3eya: "Start by creating your first gam3eya",
    monthly_contribution_for_cycle: "Monthly contribution for cycle {cycle}",
    receiving_payout_for_gam3eya: "Receiving payout for gam3eya",
    
    // Reminders & Payments
    reminders_and_payments: "Reminders & Payments",
    schedule_a_payment: "Schedule a Payment",
    add_details_for_your_scheduled_payment: "Add details for your scheduled payment",
    optional_notes: "Optional notes",
    recurring: "Recurring",
    select_recurrence: "Select recurrence",
    weekly: "Weekly",
    bi_weekly: "Bi-weekly",
    monthly: "Monthly",
    quarterly: "Quarterly",
    yearly: "Yearly",
    
    // Wallet types
    select_wallet_type: "Select wallet type",
    bank: "Bank",
    savings: "Savings",
    custom: "Custom",
    
    // Common actions
    title: "Title",
    enter_title: "Enter title",
    notes: "Notes",
      // Budget
    allocated: "Allocated",
    monthly_budget: "Monthly budget",
  };

  const arTranslations = {
    dashboard: 'لوحة التحكم',
    transactions: 'المعاملات',
    budgets: 'الميزانيات',
    wallets: 'المحافظ',
    gam3eya: 'جمعية',
    reminders: 'تذكيرات',
    reports: 'تقارير',
    settings: 'إعدادات',
    login: 'تسجيل الدخول',
    register: 'تسجيل',
    logout: 'تسجيل الخروج',
    username: 'اسم المستخدم',
    email: 'البريد الإلكتروني',
    password: 'كلمة المرور',
    confirm_password: 'تأكيد كلمة المرور',
    create_account: 'إنشاء حساب',
    already_have_account: 'هل لديك حساب بالفعل؟',
    login_here: 'تسجيل الدخول هنا',
    need_an_account: 'تحتاج إلى حساب؟',
    register_here: 'سجل هنا',
    enter_username: 'أدخل اسم المستخدم الخاص بك',
    enter_email: 'أدخل بريدك الإلكتروني',
    enter_password: 'أدخل كلمة المرور الخاصة بك',
    enter_confirm_password: 'أدخل تأكيد كلمة المرور',
    invalid_email: 'بريد إلكتروني خاطئ',
    passwords_do_not_match: 'كلمات المرور غير متطابقة',
    home: 'الرئيسية',
    total_balance: 'الرصيد الإجمالي',
    income: 'الدخل',
    expenses: 'المصروفات',
    latest_transactions: 'أحدث المعاملات',
    view_all: 'عرض الكل',
    add_transaction: 'إضافة معاملة',
    date: 'التاريخ',
    amount: 'المبلغ',
    description: 'الوصف',
    category: 'الفئة',
    wallet: 'المحفظة',
    type: 'النوع',
    income_transaction: 'معاملة دخل',
    expense_transaction: 'معاملة مصروف',
    select_category: 'اختر فئة',
    select_wallet: 'اختر محفظة',
    enter_amount: 'أدخل المبلغ',
    enter_description: 'أدخل الوصف',
    add: 'إضافة',
    edit: 'تعديل',
    delete: 'حذف',
    cancel: 'إلغاء',
    are_you_sure: 'هل أنت متأكد؟',
    this_action_cannot_be_undone: 'لا يمكن التراجع عن هذا الإجراء.',
    yes_delete: 'نعم، احذف',
    no_cancel: 'لا، إلغاء',
    new_wallet: 'محفظة جديدة',
    name: 'الاسم',
    balance: 'الرصيد',
    color: 'اللون',
    type_of_wallet: 'نوع المحفظة',
    enter_name: 'أدخل الاسم',
    enter_balance: 'أدخل الرصيد',
    select_color: 'اختر اللون',
    create: 'إنشاء',
    edit_wallet: 'تعديل المحفظة',
    cash: 'نقدي',
    bank_account: 'حساب بنكي',
    credit_card: 'بطاقة ائتمان',
    debit_card: 'بطاقة خصم',
    mobile_money: 'المال عبر الهاتف المحمول',
    investment: 'استثمار',
    other: 'أخرى',
    total: 'المجموع',
    remaining: 'المتبقي',
    spent: 'صرف',
    budget_amount: 'مبلغ الميزانية',
    start_date: 'تاريخ البدء',
    end_date: 'تاريخ الانتهاء',
    create_budget: 'إنشاء ميزانية',
    edit_budget: 'تعديل الميزانية',
    enter_budget_amount: 'أدخل مبلغ الميزانية',
    select_start_date: 'اختر تاريخ البدء',
    select_end_date: 'اختر تاريخ الانتهاء',
    new_category: 'فئة جديدة',
    category_name: 'اسم الفئة',
    category_type: 'نوع الفئة',
    enter_category_name: 'أدخل اسم الفئة',
    select_category_type: 'اختر نوع الفئة',
    expense: 'مصروف',
    income_category: 'دخل',
    both: 'كلاهما',
    is_custom: 'مخصص',
    category_added_successfully: 'تمت إضافة الفئة بنجاح!',
    failed_to_add_category: 'فشل في إضافة الفئة.',
    category_already_exists: 'فئة بنفس الاسم موجودة بالفعل لهذا النوع.',
    info: 'معلومات',
    categories_reset_not_available: 'وظيفة إعادة تعيين الفئات غير متاحة بعد.',
    error: 'خطأ',
    failed_to_load_categories: 'فشل في تحميل الفئات.',
    success: 'نجاح',
    logged_in_successfully: 'تم تسجيل الدخول بنجاح!',
    registered_successfully: 'تم التسجيل بنجاح!',
    logged_out_successfully: 'تم تسجيل الخروج بنجاح!',
    invalid_credentials: 'بيانات اعتماد غير صالحة',
    monthly: "شهري",
    yearly: "سنوي",
    monthly_comparison: "الدخل مقابل المصروفات الشهرية",
    yearly_comparison: "الدخل مقابل المصروفات السنوية",    monthly_cash_flow: "تحليل التدفق النقدي الشهري",
    yearly_cash_flow: "تحليل التدفق النقدي السنوي",
    cash_flow: "التدفق النقدي",
    monthly_distribution: "توزيع المصروفات الشهرية",
    yearly_distribution: "توزيع المصروفات السنوية",
    income_expense_comparison_description: "قارن دخلك ومصروفاتك على مر الزمن",
    cash_flow_description: "تتبع صافي التدفق النقدي والرصيد الجاري",
    expense_distribution_description: "معرفة أين تذهب أموالك",
    wallet_transaction_history: "سجل المعاملات الأخيرة",
    uncategorized: "غير مصنف",
    
    // Login & Register specific
    login_title: "تسجيل الدخول",
    enter_email_password: "أدخل بريدك الإلكتروني وكلمة المرور للوصول إلى حسابك",
    your_email: "بريدك الإلكتروني",
    your_password: "كلمة المرور الخاصة بك",
    logging_in: "جاري تسجيل الدخول...",
    dont_have_account: "ليس لديك حساب؟",
    create_account_title: "إنشاء حساب",
    enter_details_new_account: "أدخل بياناتك لإنشاء حساب جديد",
    your_username: "اسم المستخدم الخاص بك",
    create_a_password: "إنشاء كلمة مرور",
    confirm_your_password: "تأكيد كلمة المرور",
    creating_account: "جاري إنشاء الحساب...",
      // Settings
    phone: "الهاتف",
    profile_settings: "إعدادات الملف الشخصي",
    language_settings: "إعدادات اللغة",
    current_language: "اللغة الحالية",
    switch_to_arabic: "تغيير إلى العربية",
    switch_to_english: "تغيير إلى الإنجليزية",
    notifications: "الإشعارات",
    manage_notifications: "إدارة تفضيلات الإشعارات",
    email_notifications: "إشعارات البريد الإلكتروني",
    receive_email_updates: "تلقي تحديثات البريد الإلكتروني حول حسابك",
    push_notifications: "الإشعارات الفورية",
    receive_push_notifications: "تلقي الإشعارات الفورية على جهازك",
    security: "الأمان",
    change_password: "تغيير كلمة المرور",
    manage_connected_accounts: "إدارة الحسابات المتصلة",
    profile_updated: "تم تحديث الملف الشخصي",
    profile_updated_successfully: "تم تحديث ملفك الشخصي بنجاح",
    not_available: "غير متوفر",    username_required: "اسم المستخدم مطلوب",
    email_required: "البريد الإلكتروني مطلوب",
    
    // Loading states
    email_notifications: "إشعارات البريد الإلكتروني",
    receive_email_updates: "تلقي تحديثات البريد الإلكتروني",
    push_notifications: "الإشعارات الفورية",
    receive_push_notifications: "تلقي الإشعارات الفورية",
    security: "الأمان",
    
    // Loading states
    loading: "جاري التحميل",
    loading_wallets: "جاري تحميل المحافظ",
    loading_reports_data: "جاري تحميل بيانات التقارير",
    loading_gam3eyas: "جاري تحميل الجمعيات",
    
    // Placeholders
    amount_placeholder: "0.00",
    phone_placeholder: "+20 123 456 7890",
    
    // Validation messages
    please_enter_valid_email: "يرجى إدخال بريد إلكتروني صالح",
    password_min_6_chars: "يجب أن تكون كلمة المرور على الأقل 6 أحرف",
    username_min_3_chars: "يجب أن يكون اسم المستخدم على الأقل 3 أحرف",
    name_required: "الاسم مطلوب",
    amount_must_be_positive: "يجب أن يكون المبلغ موجباً",
    members_must_be_positive: "يجب أن يكون عدد الأعضاء موجباً",
    contribution_must_be_positive: "يجب أن تكون المساهمة موجبة",
    start_date_required: "تاريخ البدء مطلوب",
    end_date_required: "تاريخ الانتهاء مطلوب",
    
    // Gam3eya specific
    gam3eya_name: "اسم الجمعية",
    total_amount: "المبلغ الإجمالي",
    monthly_contribution: "المساهمة الشهرية",
    members_count: "عدد الأعضاء",
    calculated_from_members: "محسوب من المبلغ الإجمالي ÷ الأعضاء",
    calculated_automatically: "محسوب تلقائياً",
    my_turn: "دوري",
    which_cycle_you_receive: "أي دورة تستلم فيها المبلغ",
    current_cycle: "الدورة الحالية",
    cycle: "دورة",
    halfway_complete: "مكتمل نصف الطريق",
    edit_gam3eya: "تعديل الجمعية",
    create_new_gam3eya: "إنشاء جمعية جديدة",
    fill_details_to_create_gam3eya: "املأ التفاصيل لإنشاء جمعيتك",
    delete_gam3eya: "حذف الجمعية",
    delete_gam3eya_confirmation: "هل أنت متأكد من حذف {name}؟",
    save_changes: "حفظ التغييرات",
    gam3eya_created_successfully: "تم إنشاء الجمعية بنجاح",
    gam3eya_updated_successfully: "تم تحديث الجمعية بنجاح",
    gam3eya_deleted_successfully: "تم حذف الجمعية بنجاح",
    failed_to_create_gam3eya: "فشل في إنشاء الجمعية",
    failed_to_update_gam3eya: "فشل في تحديث الجمعية",
    failed_to_delete_gam3eya: "فشل في حذف الجمعية",
    failed_to_fetch_gam3eyas: "فشل في جلب الجمعيات",
    no_gam3eya_yet: "لا توجد جمعية بعد",
    start_by_creating_gam3eya: "ابدأ بإنشاء جمعيتك الأولى",
    monthly_contribution_for_cycle: "المساهمة الشهرية للدورة {cycle}",
    receiving_payout_for_gam3eya: "استلام المبلغ من الجمعية",
    
    // Reminders & Payments
    reminders_and_payments: "التذكيرات والمدفوعات",
    schedule_a_payment: "جدولة دفعة",
    add_details_for_your_scheduled_payment: "أضف تفاصيل دفعتك المجدولة",
    optional_notes: "ملاحظات اختيارية",
    recurring: "متكرر",
    select_recurrence: "اختر التكرار",
    weekly: "أسبوعي",
    bi_weekly: "كل أسبوعين",
    quarterly: "ربع سنوي",
    
    // Wallet types
    select_wallet_type: "اختر نوع المحفظة",
    bank: "بنك",
    savings: "مدخرات",
    custom: "مخصص",
    
    // Common actions
    title: "العنوان",
    enter_title: "أدخل العنوان",
    notes: "ملاحظات",    // Budget
    allocated: "مخصص",
    monthly_budget: "الميزانية الشهرية",
  };

  const translations = language === 'ar' ? arTranslations : enTranslations;
  const toggleLanguage = () => {
    setLanguage(language === 'en' ? 'ar' : 'en');
  };

  const t = (key: string) => {
    return translations[key] || key;
  };

  return (
    <LanguageContext.Provider value={{ language, t, setLanguage, toggleLanguage }}>
      {children}
    </LanguageContext.Provider>
  );
};

export const useLanguage = () => {
  const context = useContext(LanguageContext);
  if (context === undefined) {
    throw new Error('useLanguage must be used within a LanguageProvider');
  }
  return context;
};

